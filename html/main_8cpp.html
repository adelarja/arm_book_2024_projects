<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">main.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A non modularized firmware for a water level management system.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;mbed.h&quot;</code><br />
<code>#include &quot;arm_book_lib.h&quot;</code><br />
<code>#include &lt;cstdint&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for main.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="main_8cpp__incl.png" border="0" usemap="#amain_8cpp" alt=""/></div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structButton.html">Button</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure to hold buttons data.  <a href="structButton.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTank.html">Tank</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure to hold tanks data.  <a href="structTank.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae14acb6aac55d18e64e415d9e2bf8f01"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ae14acb6aac55d18e64e415d9e2bf8f01">WATER_LEVEL_THRESHOLD</a>&#160;&#160;&#160;0.8</td></tr>
<tr class="separator:ae14acb6aac55d18e64e415d9e2bf8f01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea4d12715936bf0419a42ee8fd4fc36e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#aea4d12715936bf0419a42ee8fd4fc36e">NUMBER_OF_AVG_SAMPLES</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:aea4d12715936bf0419a42ee8fd4fc36e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00aef9e8dd001a49f8717031d84b2c6c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a00aef9e8dd001a49f8717031d84b2c6c">DEBOUNCE_TIME</a>&#160;&#160;&#160;50000</td></tr>
<tr class="separator:a00aef9e8dd001a49f8717031d84b2c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1a38527e908beeb0fd600336e2f8bfb"><td class="memItemLeft" align="right" valign="top"><a id="ae1a38527e908beeb0fd600336e2f8bfb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAIN_DELAY</b>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ae1a38527e908beeb0fd600336e2f8bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a228d31ce7d948d88e43162685a23e220"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a228d31ce7d948d88e43162685a23e220">MANUAL_MODE_BUTTON</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a228d31ce7d948d88e43162685a23e220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad267adcc7755e3065441c1c504d4d430"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ad267adcc7755e3065441c1c504d4d430">SOLENOID_VALVE_1_BUTTON</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ad267adcc7755e3065441c1c504d4d430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7fd85ca6dc85ef9d46b3fc59fae73fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ac7fd85ca6dc85ef9d46b3fc59fae73fb">SOLENOID_VALVE_2_BUTTON</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ac7fd85ca6dc85ef9d46b3fc59fae73fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d2293f522a33da50f5f98ceeed77fa5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a4d2293f522a33da50f5f98ceeed77fa5">WATER_PUMP_BUTTON</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a4d2293f522a33da50f5f98ceeed77fa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e76690e043bae4351e8b1849710f165"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a6e76690e043bae4351e8b1849710f165">NUMBER_OF_TANKS</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a6e76690e043bae4351e8b1849710f165"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad49ff21a38bf59699b141283d67444d2"><td class="memItemLeft" align="right" valign="top"><a id="ad49ff21a38bf59699b141283d67444d2"></a>
UnbufferedSerial&#160;</td><td class="memItemRight" valign="bottom"><b>uartUsb</b> (USBTX, USBRX, 115200)</td></tr>
<tr class="separator:ad49ff21a38bf59699b141283d67444d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5225cb66d91a0766757acd370b60c6f7"><td class="memItemLeft" align="right" valign="top"><a id="a5225cb66d91a0766757acd370b60c6f7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>inputsInit</b> ()</td></tr>
<tr class="separator:a5225cb66d91a0766757acd370b60c6f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad612e2eed79b422051ceaa16df38c183"><td class="memItemLeft" align="right" valign="top"><a id="ad612e2eed79b422051ceaa16df38c183"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ad612e2eed79b422051ceaa16df38c183">outputsInit</a> ()</td></tr>
<tr class="memdesc:ad612e2eed79b422051ceaa16df38c183"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iterates over the tanks array and initiate the actuators and leds with the OFF value. <br /></td></tr>
<tr class="separator:ad612e2eed79b422051ceaa16df38c183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb9a51a29487781a8a640119b23cca72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#afb9a51a29487781a8a640119b23cca72">getTanksWaterLevel</a> ()</td></tr>
<tr class="memdesc:afb9a51a29487781a8a640119b23cca72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function used to calculate the water level in the tanks, saving the information in the structs of the tanks array.  <a href="main_8cpp.html#afb9a51a29487781a8a640119b23cca72">More...</a><br /></td></tr>
<tr class="separator:afb9a51a29487781a8a640119b23cca72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa12b114a8ad4c895d5bb7a7f24ba0a61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#aa12b114a8ad4c895d5bb7a7f24ba0a61">manageWaterLevel</a> ()</td></tr>
<tr class="memdesc:aa12b114a8ad4c895d5bb7a7f24ba0a61"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the management system for the automatic water level management.  <a href="main_8cpp.html#aa12b114a8ad4c895d5bb7a7f24ba0a61">More...</a><br /></td></tr>
<tr class="separator:aa12b114a8ad4c895d5bb7a7f24ba0a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cd9c02ae085896800c7704dfa969a24"><td class="memItemLeft" align="right" valign="top"><a id="a1cd9c02ae085896800c7704dfa969a24"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a1cd9c02ae085896800c7704dfa969a24">availableCommands</a> ()</td></tr>
<tr class="memdesc:a1cd9c02ae085896800c7704dfa969a24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Available commands for the serial GUI. <br /></td></tr>
<tr class="separator:a1cd9c02ae085896800c7704dfa969a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7608cc2745aacf4015d26cd4ff79d4aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a7608cc2745aacf4015d26cd4ff79d4aa">debounceButton</a> (<a class="el" href="structButton.html">Button</a> *button)</td></tr>
<tr class="memdesc:a7608cc2745aacf4015d26cd4ff79d4aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Debounce function for the buttons.  <a href="main_8cpp.html#a7608cc2745aacf4015d26cd4ff79d4aa">More...</a><br /></td></tr>
<tr class="separator:a7608cc2745aacf4015d26cd4ff79d4aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d3fe55c02bba21088185ebbf7768240"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a6d3fe55c02bba21088185ebbf7768240">buttonsInit</a> ()</td></tr>
<tr class="memdesc:a6d3fe55c02bba21088185ebbf7768240"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init the buttons of the system as pull-ups. Init the timers for the buttons.  <a href="main_8cpp.html#a6d3fe55c02bba21088185ebbf7768240">More...</a><br /></td></tr>
<tr class="separator:a6d3fe55c02bba21088185ebbf7768240"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af64eddc7833f2e6a4cf922e27a69e094"><td class="memItemLeft" align="right" valign="top"><a id="af64eddc7833f2e6a4cf922e27a69e094"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#af64eddc7833f2e6a4cf922e27a69e094">uartTask</a> ()</td></tr>
<tr class="memdesc:af64eddc7833f2e6a4cf922e27a69e094"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serial GUI to ask the water level management system for information about the tanks. <br /></td></tr>
<tr class="separator:af64eddc7833f2e6a4cf922e27a69e094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca8858ecc85692928e8b4055e2900142"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#aca8858ecc85692928e8b4055e2900142">manualLevelManagement</a> ()</td></tr>
<tr class="memdesc:aca8858ecc85692928e8b4055e2900142"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to check if an actuator button was pressed, or to check if the manual system was deactivated.  <a href="main_8cpp.html#aca8858ecc85692928e8b4055e2900142">More...</a><br /></td></tr>
<tr class="separator:aca8858ecc85692928e8b4055e2900142"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a951c1e5e9010694cf5770eef8fc554bf"><td class="memItemLeft" align="right" valign="top"><a id="a951c1e5e9010694cf5770eef8fc554bf"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a951c1e5e9010694cf5770eef8fc554bf">checkManualManagementSwitch</a> ()</td></tr>
<tr class="memdesc:a951c1e5e9010694cf5770eef8fc554bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the manual operation was activated (when working in the automatic management operation) <br /></td></tr>
<tr class="separator:a951c1e5e9010694cf5770eef8fc554bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memItemLeft" align="right" valign="top"><a id="ae66f6b31b5ad750f1fe042a706a4e3d4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> ()</td></tr>
<tr class="separator:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a22ecbc95a262a416dd0b096d5cbe1cb5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structButton.html">Button</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a22ecbc95a262a416dd0b096d5cbe1cb5">buttons</a> [4]</td></tr>
<tr class="separator:a22ecbc95a262a416dd0b096d5cbe1cb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a585e52f63ecc348980314158e681055f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structTank.html">Tank</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a585e52f63ecc348980314158e681055f">tanks</a> [<a class="el" href="main_8cpp.html#a6e76690e043bae4351e8b1849710f165">NUMBER_OF_TANKS</a>]</td></tr>
<tr class="separator:a585e52f63ecc348980314158e681055f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab127ce8f089f95d020f232f993fa8388"><td class="memItemLeft" align="right" valign="top"><a id="ab127ce8f089f95d020f232f993fa8388"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>manualMode</b> = false</td></tr>
<tr class="separator:ab127ce8f089f95d020f232f993fa8388"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A non modularized firmware for a water level management system. </p>
<p>This file contains the function and data structures used for the system. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a00aef9e8dd001a49f8717031d84b2c6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00aef9e8dd001a49f8717031d84b2c6c">&#9670;&nbsp;</a></span>DEBOUNCE_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBOUNCE_TIME&#160;&#160;&#160;50000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Debounce time in microseconds </p>

</div>
</div>
<a id="a228d31ce7d948d88e43162685a23e220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a228d31ce7d948d88e43162685a23e220">&#9670;&nbsp;</a></span>MANUAL_MODE_BUTTON</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MANUAL_MODE_BUTTON&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structButton.html" title="Structure to hold buttons data.">Button</a> to be used to switch between manual and automatic operation </p>

</div>
</div>
<a id="aea4d12715936bf0419a42ee8fd4fc36e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea4d12715936bf0419a42ee8fd4fc36e">&#9670;&nbsp;</a></span>NUMBER_OF_AVG_SAMPLES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUMBER_OF_AVG_SAMPLES&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of samples to be used to calculate the analog sensor reading average </p>

</div>
</div>
<a id="a6e76690e043bae4351e8b1849710f165"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e76690e043bae4351e8b1849710f165">&#9670;&nbsp;</a></span>NUMBER_OF_TANKS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUMBER_OF_TANKS&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of tanks of the system </p>

</div>
</div>
<a id="ad267adcc7755e3065441c1c504d4d430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad267adcc7755e3065441c1c504d4d430">&#9670;&nbsp;</a></span>SOLENOID_VALVE_1_BUTTON</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOLENOID_VALVE_1_BUTTON&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structButton.html" title="Structure to hold buttons data.">Button</a> used to activate/deactivate the solenoid valve 1 </p>

</div>
</div>
<a id="ac7fd85ca6dc85ef9d46b3fc59fae73fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7fd85ca6dc85ef9d46b3fc59fae73fb">&#9670;&nbsp;</a></span>SOLENOID_VALVE_2_BUTTON</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOLENOID_VALVE_2_BUTTON&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structButton.html" title="Structure to hold buttons data.">Button</a> used to activate/deactivate the solenoid valve 2 </p>

</div>
</div>
<a id="ae14acb6aac55d18e64e415d9e2bf8f01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae14acb6aac55d18e64e415d9e2bf8f01">&#9670;&nbsp;</a></span>WATER_LEVEL_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WATER_LEVEL_THRESHOLD&#160;&#160;&#160;0.8</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When the level sensor is below this value, the tank needs to be filled </p>

</div>
</div>
<a id="a4d2293f522a33da50f5f98ceeed77fa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d2293f522a33da50f5f98ceeed77fa5">&#9670;&nbsp;</a></span>WATER_PUMP_BUTTON</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WATER_PUMP_BUTTON&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structButton.html" title="Structure to hold buttons data.">Button</a> used to activate/deactivate the water pump </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6d3fe55c02bba21088185ebbf7768240"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d3fe55c02bba21088185ebbf7768240">&#9670;&nbsp;</a></span>buttonsInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buttonsInit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init the buttons of the system as pull-ups. Init the timers for the buttons. </p>
<dl class="section attention"><dt>Attention</dt><dd>The timers were not introduced in the course yet. I found these tools useful for the debounce function. </dd>
<dd>
Nevertheless I'll implement a delay in the main function, and check in each button if the debounce time </dd>
<dd>
has ended. </dd></dl>

</div>
</div>
<a id="a7608cc2745aacf4015d26cd4ff79d4aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7608cc2745aacf4015d26cd4ff79d4aa">&#9670;&nbsp;</a></span>debounceButton()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void debounceButton </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structButton.html">Button</a> *&#160;</td>
          <td class="paramname"><em>button</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Debounce function for the buttons. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd><p class="startdd">Change it for a FSM. I didn't use it because it is out of the assignment scope, since FSM are a topic covered </p>
<p class="enddd">in the next chapters. </p>
</dd></dl>

</div>
</div>
<a id="afb9a51a29487781a8a640119b23cca72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb9a51a29487781a8a640119b23cca72">&#9670;&nbsp;</a></span>getTanksWaterLevel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getTanksWaterLevel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function used to calculate the water level in the tanks, saving the information in the structs of the tanks array. </p>
<p>The sensors readings are saved into the levelSensorsReadingsArray. All the readings in the array are then averaged to obtain a more reliable analog measure.</p>
<p>The arrays are filled replacing the older measures by the new ones. At the begining, when the array is empty, the measure is not accurate. In our case, the system gets stable once the array is filled (imperceptible time).</p>
<p>The <a class="el" href="structTank.html" title="Structure to hold tanks data.">Tank</a> struct and the tanks array helps to avoid code repetition here. All the measures are saved in the <a class="el" href="structTank.html" title="Structure to hold tanks data.">Tank</a> structs initialized in the tanks array. </p>

</div>
</div>
<a id="aa12b114a8ad4c895d5bb7a7f24ba0a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa12b114a8ad4c895d5bb7a7f24ba0a61">&#9670;&nbsp;</a></span>manageWaterLevel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void manageWaterLevel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the management system for the automatic water level management. </p>
<p>Iterate over all tanks in the systems and check if the water level is below the water level threshold. In case it is, turn on the actuator and the led of the tank. In case it is not turn them off. </p>

</div>
</div>
<a id="aca8858ecc85692928e8b4055e2900142"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca8858ecc85692928e8b4055e2900142">&#9670;&nbsp;</a></span>manualLevelManagement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void manualLevelManagement </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to check if an actuator button was pressed, or to check if the manual system was deactivated. </p>
<p>If a button of the actuator was pressed, we used that information to activate/deactivate the actuator and the led. Once this happens, the processed flag of the button is activated and the debounce function prevents re-entering the conditional on line 309 (we ensure that the program enters the conditional only once per button press). </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a22ecbc95a262a416dd0b096d5cbe1cb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22ecbc95a262a416dd0b096d5cbe1cb5">&#9670;&nbsp;</a></span>buttons</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structButton.html">Button</a> buttons[4]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    {DigitalIn(D5), 1, 1, Timer(), <span class="keyword">false</span>, <span class="keyword">false</span>},</div>
<div class="line">    {DigitalIn(D6), 1, 1, Timer(), <span class="keyword">false</span>, <span class="keyword">false</span>},</div>
<div class="line">    {DigitalIn(D7), 1, 1, Timer(), <span class="keyword">false</span>, <span class="keyword">false</span>},</div>
<div class="line">    {DigitalIn(D8), 1, 1, Timer(), <span class="keyword">false</span>, <span class="keyword">false</span>},</div>
<div class="line">}</div>
</div><!-- fragment --><p>Array of buttons. Helps avoiding code repetition and handling the button events in an easy way. </p>

</div>
</div>
<a id="a585e52f63ecc348980314158e681055f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a585e52f63ecc348980314158e681055f">&#9670;&nbsp;</a></span>tanks</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structTank.html">Tank</a> tanks[<a class="el" href="main_8cpp.html#a6e76690e043bae4351e8b1849710f165">NUMBER_OF_TANKS</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    {AnalogIn(A0), DigitalOut(D2), DigitalOut(LED1), <a class="code" href="main_8cpp.html#a4d2293f522a33da50f5f98ceeed77fa5">WATER_PUMP_BUTTON</a>, 0, 0, 0, 0, 0, 0},</div>
<div class="line">    {AnalogIn(A1), DigitalOut(D3), DigitalOut(LED2), <a class="code" href="main_8cpp.html#ad267adcc7755e3065441c1c504d4d430">SOLENOID_VALVE_1_BUTTON</a>, 0, 0, 0, 0, 0, 0},</div>
<div class="line">    {AnalogIn(A2), DigitalOut(D4), DigitalOut(LED3), <a class="code" href="main_8cpp.html#ac7fd85ca6dc85ef9d46b3fc59fae73fb">SOLENOID_VALVE_2_BUTTON</a>, 0, 0, 0, 0, 0, 0},</div>
<div class="line">}</div>
<div class="ttc" id="amain_8cpp_html_a4d2293f522a33da50f5f98ceeed77fa5"><div class="ttname"><a href="main_8cpp.html#a4d2293f522a33da50f5f98ceeed77fa5">WATER_PUMP_BUTTON</a></div><div class="ttdeci">#define WATER_PUMP_BUTTON</div><div class="ttdef"><b>Definition:</b> main.cpp:20</div></div>
<div class="ttc" id="amain_8cpp_html_ac7fd85ca6dc85ef9d46b3fc59fae73fb"><div class="ttname"><a href="main_8cpp.html#ac7fd85ca6dc85ef9d46b3fc59fae73fb">SOLENOID_VALVE_2_BUTTON</a></div><div class="ttdeci">#define SOLENOID_VALVE_2_BUTTON</div><div class="ttdef"><b>Definition:</b> main.cpp:19</div></div>
<div class="ttc" id="amain_8cpp_html_ad267adcc7755e3065441c1c504d4d430"><div class="ttname"><a href="main_8cpp.html#ad267adcc7755e3065441c1c504d4d430">SOLENOID_VALVE_1_BUTTON</a></div><div class="ttdeci">#define SOLENOID_VALVE_1_BUTTON</div><div class="ttdef"><b>Definition:</b> main.cpp:18</div></div>
</div><!-- fragment --><p>Array of tanks. Helps avoiding code repetition and managing the level sensors readings and actuators activation. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
